# ubibot-sp1

## 2019-06-20 11:07:58 
孙浩原始程序

## 2019-06-21 18:59:24 
移植代码中， MQTT。。。。。 

## 2019-07-16 17:49:11 
基本移植完成，发现BUG，按键定时器与主函数定时器冲突，导致按键错乱。

## 2019-07-19 14:58:40 
实现网络控制开关、电压电流功率等数据上传云，修复7759B，代码中 0 做除数导致系统复位BUG，实现外接DS18B20读取。

## 2019-07-23 16:49:33 
完成代码移植，功能实现： OTA，外接485读取，外接DS18B20读取，数据上传， DS18B20 读取加入平均滤波功能，规避错误值。

## 2019-07-24 10:33:10 
修改数据上传采用 信号量 方式，增加开关打开，7759b 任务打开，开关关闭，任务挂起。

## 2019-07-25 09:05:00 
修改数据上传间隔使用 信号量等待时间

## 2019-09-04 15:20:43 
适应新版IDF

## 2019-09-18 18:59:50 
增加IO模拟串口 （电能计量程序暂未完成）

## 2019-09-19 15:54:07 
模拟串口定时器采用硬件定时器，待验证

## 2020-05-08 17:27:24 SP1-V0.1.19  
蓝牙支持 notify ，蓝牙事件任务无阻塞；配网错误代码 使用 Net_ErrCode；双击按键开启蓝牙；

## 2020-05-21 13:39:39 
SP1-V0.1.23 

## 2020-06-11 08:51:00 SP1-V0.1.33 
修复电能统计BUG，该版本 EC20在 read post 返回时出现问题会直接重启 EC20，或许无需重启

## 2020-06-11 17:52:34 SP1-V0.1.34 
post失败增加判断，如果时构建出现问题，则跳过一组数据；修改时间构建，改为传入指针，防止内存重复访问，用电量统计增加 初始判断，重启后自动清零

## 2020-06-12 11:25:24 SP1-V0.1.35 
EC20 会出现模块重启仍然读不到指令，重启设备便好用，目前使用 在EC20 串口接收任务中增加 uart_flush(EX_UART_NUM); 待验证。切换网络，立即将网络状态置位

## 2020-06-12 16:33:14 SP1-V0.1.36
修复EC20 uart 溢出后无法恢复的问题，修复EC20 ota 判断升级文件结束标志 ，判断标志为 "\r\n\r\nOK\r\n"

## 2020-06-12 18:30:23 SP1-V0.1.37
上条 OTA升级问题 仍然存在，本版本将判断接收到的文件大小进行判断接收是否完成

## 2020-10-29 SP1-V0.1.46-t 
修改MQTT多次发送问题，去掉收到MQTT后立即上传数据，去掉构建网络数据附带开关状态信息，修改sensors 默认值，修复恢复出厂设置，参数丢失问题

## 2020-11-06 SP1-V0.1.52-t
1，重新生成 sdkconfig , 固件体积大幅减小
2，sprintf  -> snprintf
3，恢复出厂设置 不清空重要信息

## 2020-11-26 SP1-V0.1.54-t
1，支持SIM7600G 模块，A7600待测
2，优化AT算法